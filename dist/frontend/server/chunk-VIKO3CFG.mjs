import './polyfills.server.mjs';
import{$a as f,Oa as u,b as d,e as c,i,l as o,o as p,r as n}from"./chunk-PCJ2SFZK.mjs";var m={localApiUrl:"http://192.168.0.100",tailScaleApiUrl:"http://100.112.128.60"};var I=(()=>{class a{router;http;constructor(t,e){if(this.router=t,this.http=e,typeof window<"u"){let r=window.location.hostname;console.log(r),r.startsWith("100.112.")||r==="localhost"?this.dataUrl=this.ipData.tailScaleApiUrl:this.dataUrl=this.ipData.localApiUrl}else this.dataUrl=this.ipData.localApiUrl;this.dataUrl=this.dataUrl+":8080/api"}dataUrl;ipData=m;dataSubject=new d([]);data$=this.dataSubject.asObservable();getData(t){return this.http.get(this.dataUrl+t).pipe(o(e=>this.dataSubject.next(e)),i(this.handleError))}deleteDataId(t,e){let r=`${this.dataUrl}${t}/${e}`;return this.http.delete(r).pipe(o(()=>this.refreshData(t)),i(this.handleError))}authenticateLogin(t){return this.http.post(`${this.dataUrl}/security/authenticate`,t).pipe(i(this.handleError))}modifyDataId(t,e,r="id"){let g=this.dataUrl+t;return this.http.put(g,e).pipe(o(l=>{let s=this.dataSubject.getValue(),h=s.findIndex(U=>U[r]===l[r]);h!==-1&&(s[h]=l,this.dataSubject.next([...s]))}),i(this.handleError))}refreshData(t){this.getData(t).subscribe()}handleError(t){let e="";return t.error instanceof ErrorEvent?e=`Client-side error: ${t.error.message}`:e=`Server-side error: ${t.status}
Message: ${t.message}`,c(()=>new Error(e))}isLogged(){return typeof window<"u"?!!localStorage.getItem("token_user"):!1}Logout(){typeof window<"u"&&(localStorage.removeItem("token_user"),this.router.navigate(["/login"]))}static \u0275fac=function(e){return new(e||a)(n(f),n(u))};static \u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();export{I as a};
